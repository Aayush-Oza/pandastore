<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chunri Store - Login</title>

    <link rel="stylesheet" href="..assets/css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
</head>

<body>

    <!-- HEADER -->
    <header class="header">
        <div class="container header-inner">
            <div class="brand">
  <span class="brand-icon">ğŸ¼</span>
  <span class="brand-text">Panda<span>Store</span></span>
</div>

        </div>
    </header>

    <!-- LOGIN BOX -->
    <div class="auth-box">
        <h2>Login</h2>

        <input type="email" id="email" placeholder="Enter Email">
        <div class="password-wrap">
    <input type="password" id="password" placeholder="Enter Password">
    <span class="eye" onclick="togglePassword('password', this)">ğŸ‘ï¸</span>
</div>
        <button onclick="loginUser()">Login</button>

        <p style="margin-top: 10px; text-align:center;">
            Don't have an account?
            <a href="register.html" style="color: var(--orange); font-weight: 700;">Register</a>
        </p>
        <p style="margin-top: 10px; text-align:center;">
    <a href="forgot-password.html" style="color: var(--red); font-weight: 600;">
        Forgot password?
    </a>
</p>
    </div>
<script src="assets/js/app.js"></script>
    <script>
async function loginUser() {
  const email = document.getElementById("email").value.trim();
  const password = document.getElementById("password").value.trim();

  if (!email || !password) {
    showToast("Please fill all fields", "error");
    return;
  }

  const res = await fetch(`${CONFIG.API}/auth/login`, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ email, password })
  });

  let data;
  try {
    data = await res.json();
  } catch {
    showToast("Server error", "error");
    return;
  }

  if (!res.ok) {
    showToast(data.error || "Invalid credentials", "error");
    return;
  }

  // âœ… SUCCESS
  showToast("Login successful");
  localStorage.setItem("loggedIn", "1");
  localStorage.setItem("user_id", data.user_id);

  setTimeout(() => {
    window.location.replace("index.html");
  }, 300);
}

function togglePassword(fieldId, icon) {
  const input = document.getElementById(fieldId);

  if (input.type === "password") {
    input.type = "text";
    icon.textContent = "ğŸ™ˆ";
  } else {
    input.type = "password";
    icon.textContent = "ğŸ‘ï¸";
  }
}
</script>
<div id="toast" class="toast"></div>
</body>
</html>
