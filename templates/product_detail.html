<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chunri Store - Product Details</title>

    <!-- CSS -->
    <link rel="stylesheet" href="../assets/css/style.css">

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
</head>
<body>

    <!-- HEADER -->
    <header class="header">
        <div class="container header-inner">
            <div class="brand">
  <span class="brand-icon">üêº</span>
  <span class="brand-text">Panda<span>Store</span></span>
</div>

            <div class="hamburger" onclick="toggleNav()">
                <span></span><span></span><span></span>
            </div>

            <nav class="nav">
                <ul class="nav-list">
  <li id="loginLink"><a href="login.html">Login</a></li>
  <li id="productsLink"><a href="index.html">Products</a></li>
  <li id="cartLink" style="display:none;"><a href="cart.html">Cart</a></li>
  <li id="ordersLink" style="display:none;"><a href="orders.html">Orders</a></li>
  <li id="profileLink" style="display:none;"><a href="profile.html">Profile</a></li>
  <li id="logoutLink" style="display:none;"><a href="#" onclick="logoutUser()">Logout</a></li>
</ul>
            </nav>
        </div>
    </header>

    <!-- PRODUCT DETAILS -->
    <div class="container" style="padding: 35px 0;">
        <div id="productBox"></div>
    </div>

    <!-- JS -->
    <script src="../assets/js/app.js"></script>

    <script>
let currentProduct = null; // ‚úÖ GLOBAL

document.addEventListener("DOMContentLoaded", loadProductDetails);

async function loadProductDetails() {
  const params = new URLSearchParams(window.location.search);
  const productId = params.get("id");

  if (!productId) {
    showToast("No product selected");
    location.href = "/pandastore/index.html";
    return;
  }

  const res = await fetch(`${CONFIG.API}/products`);
  const products = await res.json();

  const product = products.find(p => p.id == productId);
  if (!product) {
    showToast("Product not found");
    return;
  }

  currentProduct = product; // ‚úÖ THIS IS THE KEY LINE

  document.getElementById("productBox").innerHTML = `
    <div class="product-detail">
      <div class="product-media">
        <img src="${product.image_url || 'https://via.placeholder.com/500'}">
      </div>

      <div class="product-info">
        <span class="product-category">${product.category}</span>
        <h1 class="product-title">${product.name}</h1>
        <div class="product-no">Product No ¬∑ ${product.product_no}</div>
        <div class="product-price">‚Çπ${product.price}</div>

        <div class="product-stock ${product.stock > 0 ? "in" : "out"}">
          ${product.stock > 0
            ? `In stock (${product.stock})`
            : "Out of stock"}
        </div>

        ${product.description ? `<p class="product-desc">${product.description}</p>` : ""}

        <div class="product-actions">
          <input id="qty" type="number" min="1" value="1">
          <button onclick="handleProductAdd(${product.id})">
  Add to Cart
</button>
        </div>
      </div>
    </div>
  `;
}
function handleProductAdd(product_id) {
  const qtyInput = document.getElementById("qty");
  const qty = Number(qtyInput.value) || 1;

  addToCart(product_id, qty);
}
</script>
<div id="toast" class="toast"></div>
</body>
</html>
