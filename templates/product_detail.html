<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Panda Store ‚Äì Product Details</title>

  <!-- CSS -->
  <link rel="stylesheet" href="../assets/css/style.css">
  <link rel="stylesheet" href="../assets/css/product_detail.css">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
</head>
<body>

<header class="header">
  <div class="container header-inner">
    <div class="brand">
      <span class="brand-icon">üêº</span>
      <span class="brand-text">Panda<span>Store</span></span>
    </div>

    <div class="hamburger" onclick="toggleNav()">
      <span></span><span></span><span></span>
    </div>

    <nav class="nav">
      <ul class="nav-list">
        <li><a href="/pandastore/index.html">Products</a></li>
        <li><a href="/pandastore/templates/cart.html">Cart</a></li>
        <li><a href="/pandastore/templates/orders.html">Orders</a></li>
        <li><a href="/pandastore/templates/profile.html">Profile</a></li>
        <li><a href="#" onclick="logoutUser()">Logout</a></li>
      </ul>
    </nav>
  </div>
</header>

<main class="container product-page">
  <div id="productBox"></div>
</main>

<div id="toast" class="toast"></div>

<script src="../assets/js/app.js"></script>

<script>
document.addEventListener("DOMContentLoaded", loadProductDetails);

async function loadProductDetails() {
  const params = new URLSearchParams(window.location.search);
  const productId = params.get("id");

  if (!productId) {
    window.location.href = "/pandastore/index.html";
    return;
  }

  const res = await fetch(`${CONFIG.API}/products`);
  const products = await res.json();
  const product = products.find(p => p.id == productId);

  if (!product) {
    showToast("Product not found", "error");
    return;
  }

  document.getElementById("productBox").innerHTML = `
    <div class="product-detail-card">
      
      <div class="product-image">
        <img src="${product.image_url || 'https://via.placeholder.com/600'}" alt="${product.name}">
      </div>

      <div class="product-content">
        <span class="category">${product.category || "General"}</span>
        <h1 class="title">${product.name}</h1>

        <div class="price-row">
          <span class="price">‚Çπ${product.price}</span>
          <span class="stock ${product.stock > 0 ? "in" : "out"}">
            ${product.stock > 0 ? `In stock (${product.stock})` : "Out of stock"}
          </span>
        </div>

        ${product.description ? `<p class="description">${product.description}</p>` : ""}

        <div class="buy-box">
          <input id="qty" type="number" min="1" value="1">
          <button ${product.stock <= 0 ? "disabled" : ""} onclick="addToCart(${product.id})">
            ${product.stock > 0 ? "Add to Cart" : "Unavailable"}
          </button>
        </div>
      </div>

    </div>
  `;
}
</script>

</body>
</html>
